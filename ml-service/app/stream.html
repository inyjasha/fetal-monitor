<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Fetal Monitor Stream</title>
</head>
<body>
<h1>Потоковая сессия</h1>
<label>Session ID: <input id="sid" value="20250908-07500001"></label>
<button onclick="startStream()">Старт</button>
<pre id="log"></pre>

<script>
let ws;

function startStream() {
    const sid = document.getElementById("sid").value;
    ws = new WebSocket(`ws://localhost:8001/ws/stream/${sid}`);
    const log = document.getElementById("log");

    ws.onmessage = function(event) {
        const msg = JSON.parse(event.data);
        if(msg.frame) {
            log.textContent += `Время: ${msg.frame.time.toFixed(2)}s | BPM: ${msg.frame.bpm} | Uterus: ${msg.frame.uterus}\n`;
        } else if(msg.meta) {
            log.textContent += `=== META ===\n${JSON.stringify(msg.meta, null, 2)}\n`;
        }
        log.scrollTop = log.scrollHeight;
    }

    ws.onclose = function() {
        log.textContent += "\nСоединение закрыто";
    }
}
</script>
</body>
</html>
